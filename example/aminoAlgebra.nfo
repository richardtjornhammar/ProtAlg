ATOM      7  N   THR A   2      10.683  -2.235  28.487  1.00 29.80           N    
ATOM      8  CA  THR A   2      12.009  -2.479  27.914  1.00 27.06           C  
ATOM      9  C   THR A   2      12.444  -1.356  26.990  1.00 24.82           C  
ATOM     10  O   THR A   2      13.589  -1.356  26.538  1.00 23.35           O  
ATOM     11  CB  THR A   2      12.017  -3.817  27.155  1.00 26.92           C  
ATOM     12  OG1 THR A   2      10.872  -3.905  26.287  1.00 26.41           O  
ATOM     13  CG2 THR A   2      11.820  -4.967  28.143  1.00 29.11           C  
ATOM     14  N   ALA A   3      11.545  -0.416  26.694  1.00 25.65           N  

tot=[10.683  -2.235  28.487
12.009  -2.479  27.914
12.444  -1.356  26.990
13.589  -1.356  26.538
12.017  -3.817  27.155
10.872  -3.905  26.287
11.820  -4.967  28.143
11.545  -0.416  26.694 ]

[u,s,v] = svd(tot);
rc	= sqrt(s(1))*0.5
if( rc<4.0 )
	rc = 4.0
end 

nn=[ 10.683  -2.235  28.487 ; 11.545  -0.416  26.694 ]
cc=[ 12.009  -2.479  27.914 ; 12.017  -3.817  27.155 ]

zc = norm(n);
n 	= diff(nn);	nh = n/zc;
c 	= diff(cc);	ch = c/norm(c);
p 	= cross(nh,ch);	ph = p/norm(p);

r = [2 1 10]
x2d = dot( ph, r )
y2d = dot( qh, r )
z2d = dot( nh, r )
x2  = abs( x2d );
y2  = abs( y2d );
z2  = abs( z2d );
x = x2d/sqrt(x2)
y = y2d/sqrt(y2)
z = z2d/sqrt(z2)
sqrt( x2+y2 ) < rc, z < zc
nbins = 100


